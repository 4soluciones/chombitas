{% extends 'home.html' %}

{% block title %}
    coronasoft.dev | Reporte Masa Completa
{% endblock title %}

{% block body %}

    <div class="container-fluid pt-3">
        <div class="card">

            <div class="card-header">

                <label class="col-form-label col-form-label-lg">Reporte Masa Completa</label>

            </div>

        </div>

        <div class="card" id="content-mass">
            <div class="card-body table-responsive">



                <table class="table table-sm table-bordered" id="table-all-mass">
                    <thead>
                    <tr class="d-none">
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="cc">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c0">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c1">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c2">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c3">-</th>

                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c4">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c5">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c6">-</th>

                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c7">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c8">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c9">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c10">-</th>

                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c11">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c12">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c13">-</th>

                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c14">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c15">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c16">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c17">-</th>

                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c18">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c19">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c20">-</th>

                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c21">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c22">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c23">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c24">-</th>

                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c25">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c26">-</th>
                        <th class="bg-dark align-middle text-center" colspan="1" data-field="c27">-</th>

                    </tr>

                    </thead>
                    <tbody>
                    <tr class="text-white text-uppercase">
                        <td class="bg-dark align-middle text-center" rowspan="3">SEDE</td>
                        <td class="bg-dark align-middle text-center" colspan="7">BALON DE 10 KG</td>
                        <td class="bg-dark align-middle text-center" colspan="7">BALON DE 15 KG</td>
                        <td class="bg-dark align-middle text-center" colspan="7">BALON DE 5 KG</td>
                        <td class="bg-dark align-middle text-center" colspan="7">BALON DE 45 KG</td>
                    </tr>
                    <tr class="text-white text-uppercase">

{#                        <th class="bg-dark align-middle text-center" colspan="1">#</th>#}
                        <td class="bg-dark align-middle text-center" colspan="4">BALONES LLENOS</td>
                        <td class="bg-dark align-middle text-center" colspan="3">BALONES VACIOS</td>

                        <td class="bg-dark align-middle text-center" colspan="4">BALONES LLENOS</td>
                        <td class="bg-dark align-middle text-center" colspan="3">BALONES VACIOS</td>

                        <td class="bg-dark align-middle text-center" colspan="4">BALONES LLENOS</td>
                        <td class="bg-dark align-middle text-center" colspan="3">BALONES VACIOS</td>

                        <td class="bg-dark align-middle text-center" colspan="4">BALONES LLENOS</td>
                        <td class="bg-dark align-middle text-center" colspan="3">BALONES VACIOS</td>
                    </tr>
                    <tr class="text-white text-uppercase">
{#                        <td class="bg-dark align-middle text-center" colspan="1" data-field="subsidiary" data-sortable="true">SEDE2</td>#}
                        <td class="bg-dark align-middle text-center" colspan="1" >PLANTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1" >RUTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1" >PRESTADOS</td>
                        <td class="bg-dark align-middle text-center" colspan="1" >CARRO(R)</td>

                        <td class="bg-dark align-middle text-center" colspan="1" >PLANTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1" >RUTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1" >CARRO(R)</td>

                        <td class="bg-dark align-middle text-center" colspan="1" >PLANTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1" >RUTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1" >PRESTADOS</td>
                        <td class="bg-dark align-middle text-center" colspan="1"  >CARRO(R)</td>

                        <td class="bg-dark align-middle text-center" colspan="1"  >PLANTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1"  >RUTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1"  >CARRO(R)</td>

                        <td class="bg-dark align-middle text-center" colspan="1"  >PLANTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1"  >RUTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1"  >PRESTADOS</td>
                        <td class="bg-dark align-middle text-center" colspan="1"  >CARRO(R)</td>

                        <td class="bg-dark align-middle text-center" colspan="1"  >PLANTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1"  >RUTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1"  >CARRO(R)</td>

                        <td class="bg-dark align-middle text-center" colspan="1"  >PLANTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1"  >RUTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1"  >PRESTADOS</td>
                        <td class="bg-dark align-middle text-center" colspan="1"  >CARRO(R)</td>

                        <td class="bg-dark align-middle text-center" colspan="1"  >PLANTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1"  >RUTA</td>
                        <td class="bg-dark align-middle text-center" colspan="1"  >CARRO(R)</td>

                    </tr>

                    {% for k, s in balls.items %}
                        <tr>
                            <td class="align-middle text-center">{{ s.subsidiary_name }}</td>
                            {% for key, value in s.distributions.items %}
                                <td class="align-middle text-center">{% if value.stock_ball == 0 %}-{% else %}
                                    {{ value.stock_ball|safe|floatformat:0 }}{% endif %}</td>
                                <td class="align-middle text-center">{% if value.car_ball_filled == 0 %}-{% else %}
                                    {{ value.car_ball_filled|safe|floatformat:0 }}{% endif %}</td>
                                <td class="align-middle text-center">{% if value.ball_loan == 0 %}-{% else %}
                                    {{ value.ball_loan|safe|floatformat:0 }}{% endif %}</td>
                                <td class="align-middle text-center">{% if value.distribution_ball_filled == 0 %}
                                    -{% else %}{{ value.distribution_ball_filled|safe|floatformat:0 }}{% endif %}</td>

                                <td class="align-middle text-center">{% if value.stock_iron == 0 %}-{% else %}
                                    {{ value.stock_iron|safe|floatformat:0 }}{% endif %}</td>
                                <td class="align-middle text-center">{% if value.car_ball_void == 0 %}-{% else %}
                                    {{ value.car_ball_void|safe|floatformat:0 }}{% endif %}</td>
                                <td class="align-middle text-center">{% if value.distribution_ball_void == 0 %}
                                    -{% else %}{{ value.distribution_ball_void|safe|floatformat:0 }}{% endif %}</td>
                            {% endfor %}

                        </tr>
                    {% endfor %}


                    <tr class="bg-dark text-white">
                        <td class="align-middle text-center">TOTAL EN PLANTA</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_ball_10|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_route_filled_10|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_ball_loan_10|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_car_filled_10|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_iron_10|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_route_void_10|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_car_void_10|safe|floatformat:0 }}</td>

                        <td class="align-middle text-center" colspan="1">{{ sum_ball_15|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_route_filled_15|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_ball_loan_15|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_car_filled_15|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_iron_15|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_route_void_15|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_car_void_15|safe|floatformat:0 }}</td>

                        <td class="align-middle text-center" colspan="1">{{ sum_ball_5|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_route_filled_5|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_ball_loan_5|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_car_filled_5|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_iron_5|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_route_void_5|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_car_void_5|safe|floatformat:0 }}</td>

                        <td class="align-middle text-center" colspan="1">{{ sum_ball_45|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_route_filled_45|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_ball_loan_45|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_car_filled_45|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_iron_45|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_route_void_45|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="1">{{ sum_car_void_45|safe|floatformat:0 }}</td>
                    </tr>
                    <tr class="bg-dark text-white">
                        <td class="align-middle text-center">SUMA POR TIPO</td>
                        <td class="align-middle text-center" colspan="4">{{ sum_total_ball_filled_10|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="3">{{ sum_total_ball_void_10|safe|floatformat:0 }}</td>

                        <td class="align-middle text-center" colspan="4">{{ sum_total_ball_filled_15|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="3">{{ sum_total_ball_void_15|safe|floatformat:0 }}</td>

                        <td class="align-middle text-center" colspan="4">{{ sum_total_ball_filled_5|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="3">{{ sum_total_ball_void_5|safe|floatformat:0 }}</td>

                        <td class="align-middle text-center" colspan="4">{{ sum_total_ball_filled_45|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="3">{{ sum_total_ball_void_45|safe|floatformat:0 }}</td>

                    </tr>
                    <tr class="bg-dark text-white">
                        <td class="align-middle text-center">SUMA TOTAL</td>
                        <td class="align-middle text-center" colspan="7">{{ sum_total_ball_10|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="7">{{ sum_total_ball_15|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="7">{{ sum_total_ball_5|safe|floatformat:0 }}</td>
                        <td class="align-middle text-center" colspan="7">{{ sum_total_ball_45|safe|floatformat:0 }}</td>

                    </tr>
                    </tbody>
                    <tfoot>

                    <tr class="d-none">
                        <th class="align-middle text-center" colspan="1">SEDE</th>
                        <th class="align-middle text-center" colspan="1">PLANTA</th>
                        <th class="align-middle text-center" colspan="1">RUTA</th>
                        <th class="align-middle text-center" colspan="1">PRESTADOS</th>
                        <th class="align-middle text-center" colspan="1">CARRO(R)</th>

                        <th class="align-middle text-center" colspan="1">PLANTA</th>
                        <th class="align-middle text-center" colspan="1">RUTA</th>
                        <th class="align-middle text-center" colspan="1">CARRO(R)</th>

                        <th class="align-middle text-center" colspan="1">PLANTA</th>
                        <th class="align-middle text-center" colspan="1">RUTA</th>
                        <th class="align-middle text-center" colspan="1">PRESTADOS</th>
                        <th class="align-middle text-center" colspan="1">CARRO(R)</th>

                        <th class="align-middle text-center" colspan="1">PLANTA</th>
                        <th class="align-middle text-center" colspan="1">RUTA</th>
                        <th class="align-middle text-center" colspan="1">CARRO(R)</th>

                        <th class="align-middle text-center" colspan="1">PLANTA</th>
                        <th class="align-middle text-center" colspan="1">RUTA</th>
                        <th class="align-middle text-center" colspan="1">PRESTADOS</th>
                        <th class="align-middle text-center" colspan="1">CARRO(R)</th>

                        <th class="align-middle text-center" colspan="1">PLANTA</th>
                        <th class="align-middle text-center" colspan="1">RUTA</th>
                        <th class="align-middle text-center" colspan="1">CARRO(R)</th>

                        <th class="align-middle text-center" colspan="1">PLANTA</th>
                        <th class="align-middle text-center" colspan="1">RUTA</th>
                        <th class="align-middle text-center" colspan="1">PRESTADOS</th>
                        <th class="align-middle text-center" colspan="1">CARRO(R)</th>

                        <th class="align-middle text-center" colspan="1">PLANTA</th>
                        <th class="align-middle text-center" colspan="1">RUTA</th>
                        <th class="align-middle text-center" colspan="1">CARRO(R)</th>

                    </tr>
                    </tfoot>
                </table>


            </div>
        </div>
    </div>

{% endblock body %}

{% block extrajs %}

    <script type="text/javascript">

        $(function () {
            $('#table-all-mass').bootstrapTable({
                //pagination: true,
                showFooter: false,
                //search: true,
                showExport: true,
                //filter: true,
                //showRefresh:true,
                showPrint: true,
                //showColumns: true,
                showFullScreen: true,
                //pageList:[10, 25, 50, 100, 'All'],
                //showPaginationSwitch: true,
                exportDataType: 'all',
                exportTypes: ['pdf', 'excel', 'xlsx', 'txt', 'json', 'xml'],
                //exportFooter: true,

                exportOptions: {
                    fileName: 'tableAllMass',
                    buttons:[{
                        {#extend: 'excel',#}
                        {#text: 'Export Search Results',#}
                        className: 'btn btn-primary',
                    }],
                    type: 'pdf',
                    className: 'btn btn-primary',
                    jspdf: {
                        orientation: 'l',
                        format: 'bestfit', //a3, bestfit
                        margins: {left: 10, right: 10, top: 20, bottom: 20},
                        autotable: {
                            styles: {
                                fillColor: '#fff',
                                textColor: '#343a40',
                                fontSize: 10,
                                valign: 'middle',
                                lineWidth: 0.02,
                                lineColor: '#343a40'
                            },
                            tableLineColor: '#409EFF',
                            tableWidth: 'wrap', // auto
                            theme: 'grid',
                            //tableExport: {onBeforeAutotable: DoBeforeAutotable, onCellData: DoCellData}

                        }
                    }
                },
                ignoreRow: [],

            });


            $('#printReportExcel').click(function () {
                $("#table-all-mass").table2excel({filename: "Employees.xls"});
            });

        });

    </script>

{% endblock extrajs %}